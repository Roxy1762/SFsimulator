/**
 * 触摸设备优化样式
 * 需求: 6.1, 6.2, 6.3, 6.4 - 触摸目标优化
 * 
 * Property 9: Touch Target Size Compliance
 * *For any* interactive element (button, link, clickable area) on touch devices, 
 * the minimum dimensions should be 44px × 44px, and the minimum spacing between 
 * adjacent targets should be 8px.
 * 
 * Property 10: Button Wrapping
 * *For any* row of buttons that exceeds the container width, the buttons should 
 * wrap to multiple rows rather than causing horizontal overflow.
 * 
 * **Validates: Requirements 6.1, 6.2, 6.3, 6.4**
 */

/* ============================================
   CSS 变量定义
   ============================================ */
:root {
  --touch-target-min: 44px;
  --touch-target-spacing: 8px;
  --touch-feedback-scale: 0.95;
  --touch-feedback-opacity: 0.85;
}

/* ============================================
   触摸设备检测
   使用 pointer: coarse 检测触摸设备
   需求: 6.1 - 触摸目标最小尺寸 44px
   ============================================ */

@media (pointer: coarse) {
  /* ==================== 全局触摸目标优化 ==================== */
  
  /* 所有按钮的最小触摸目标尺寸 - 需求: 6.1 */
  button,
  [role="button"],
  .clickable,
  input[type="button"],
  input[type="submit"],
  input[type="reset"] {
    min-width: var(--touch-target-min);
    min-height: var(--touch-target-min);
    /* 确保触摸区域足够大 */
    touch-action: manipulation;
  }
  
  /* 链接和可点击元素 */
  a,
  [tabindex="0"] {
    min-height: var(--touch-target-min);
    display: inline-flex;
    align-items: center;
  }
  
  /* ==================== 操作按钮优化 ==================== */
  
  /* 操作按钮 - 增加内边距和间距 */
  .operation-button {
    min-height: 60px;
    padding: 1rem;
    margin: 0.5rem 0;
  }
  
  /* 类别按钮 - 确保最小触摸目标 */
  .category-button {
    min-height: 80px;
    min-width: 80px;
    padding: 1rem 0.75rem;
  }
  
  /* ==================== 回合控制按钮优化 ==================== */
  
  /* 结束回合按钮 */
  .end-turn-button {
    min-height: 60px;
    padding: 1rem 1.5rem;
  }
  
  /* ==================== 团队面板按钮优化 ==================== */
  
  /* 解雇按钮 */
  .fire-button {
    min-width: 60px;
    min-height: 44px;
    padding: 0.5rem 1rem;
  }
  
  /* 雇佣按钮 */
  .hire-button {
    min-height: 44px;
    padding: 0.75rem 1rem;
  }
  
  /* ==================== 保存/加载面板按钮优化 ==================== */
  
  .save-load-btn {
    min-height: 44px;
    padding: 0.75rem 1rem;
  }
  
  /* ==================== 移动端导航优化 ==================== */
  
  .mobile-nav-item {
    min-width: 60px;
    min-height: 50px;
    padding: 0.5rem;
  }
  
  /* ==================== 弹窗按钮优化 ==================== */
  
  /* 弹窗关闭按钮 */
  .modal-close-btn,
  .close-btn {
    min-width: 44px;
    min-height: 44px;
    width: 44px;
    height: 44px;
  }
  
  /* 弹窗确认/取消按钮 */
  .cancel-btn,
  .confirm-btn {
    min-height: 44px;
    padding: 0.75rem 1.5rem;
  }
  
  /* 粘贴按钮 */
  .paste-btn {
    min-height: 44px;
    padding: 0.75rem;
  }
  
  /* ==================== 词条标签优化 ==================== */
  
  /* 词条标签 - 增加触摸区域 */
  .trait-tag {
    min-height: 36px;
    padding: 0.5rem 0.75rem;
  }
  
  .candidate-trait {
    min-height: 32px;
    padding: 0.375rem 0.5rem;
  }
  
  /* ==================== 教程和引导按钮优化 ==================== */
  
  /* 帮助按钮 */
  .help-button,
  .tutorial-button,
  .onboarding-button {
    min-width: 44px;
    min-height: 44px;
  }
  
  /* ==================== 考核弹窗按钮优化 ==================== */
  
  .exam-button,
  .exam-action-btn {
    min-height: 48px;
    padding: 0.875rem 1.25rem;
  }
  
  /* ==================== 游戏结束弹窗按钮优化 ==================== */
  
  .game-over-button,
  .restart-button {
    min-height: 48px;
    padding: 0.875rem 1.5rem;
  }
  
  /* ==================== 按钮间距和换行 ==================== */
  /* 需求: 6.2 - 按钮间距 8px */
  /* 需求: 6.3 - 按钮换行支持 */
  
  /* 操作按钮列表间距 */
  .modal-operations {
    gap: var(--touch-target-spacing);
    flex-wrap: wrap;
  }
  
  /* 类别按钮网格间距 */
  .category-buttons-grid {
    gap: var(--touch-target-spacing);
    flex-wrap: wrap;
  }
  
  /* 保存/加载按钮间距 */
  .save-load-buttons {
    gap: var(--touch-target-spacing);
    flex-wrap: wrap;
  }
  
  /* 弹窗底部按钮间距 */
  .import-modal-footer {
    gap: var(--touch-target-spacing);
    flex-wrap: wrap;
  }
  
  /* 团队成员列表间距 */
  .team-members-list {
    gap: var(--touch-target-spacing);
  }
  
  /* 候选人列表间距 */
  .candidates-list {
    gap: var(--touch-target-spacing);
  }
  
  /* 通用按钮组 - 需求: 6.2, 6.3 */
  .button-group,
  .btn-group,
  .actions,
  .action-buttons {
    gap: var(--touch-target-spacing);
    flex-wrap: wrap;
  }
  
  /* ==================== 输入框优化 ==================== */
  
  /* 文本输入框 */
  input[type="text"],
  input[type="number"],
  input[type="email"],
  input[type="password"],
  textarea {
    min-height: 44px;
    padding: 0.75rem;
    font-size: 16px; /* 防止 iOS 缩放 */
  }
  
  /* 导入文本框 */
  .import-textarea {
    min-height: 120px;
    font-size: 16px;
  }
  
  /* ==================== 滚动条优化 ==================== */
  
  /* 增加滚动条宽度便于触摸 */
  ::-webkit-scrollbar {
    width: 12px;
    height: 12px;
  }
  
  .log-container::-webkit-scrollbar {
    width: 10px;
  }
}

/* ============================================
   移动端特定优化 (<768px)
   ============================================ */

@media (pointer: coarse) and (max-width: 767px) {
  /* 进一步增加触摸目标尺寸 */
  button,
  [role="button"] {
    min-height: 48px;
  }
  
  /* 操作按钮 */
  .operation-button {
    min-height: 70px;
    margin: 0.625rem 0;
  }
  
  /* 类别按钮 */
  .category-button {
    min-height: 70px;
  }
  
  /* 移动端导航 */
  .mobile-nav-item {
    min-width: 56px;
    min-height: 56px;
  }
  
  /* 增加按钮间距 */
  .modal-operations {
    gap: 1.25rem;
  }
  
  .category-buttons-grid {
    gap: 0.875rem;
  }
}

/* ============================================
   小屏手机优化 (<480px)
   ============================================ */

@media (pointer: coarse) and (max-width: 479px) {
  /* 保持最小触摸目标但优化布局 */
  .category-button {
    min-height: 64px;
    padding: 0.75rem 0.5rem;
  }
  
  /* 紧凑但仍可触摸的按钮 */
  .save-load-btn {
    min-height: 44px;
    padding: 0.625rem 0.75rem;
  }
  
  /* 弹窗按钮 */
  .modal-close-btn {
    width: 40px;
    height: 40px;
    min-width: 40px;
    min-height: 40px;
  }
}

/* ============================================
   触摸反馈优化
   需求: 6.4 - 触摸反馈样式
   ============================================ */

@media (pointer: coarse) {
  /* 触摸时的视觉反馈 - 需求: 6.4 */
  button:active:not(:disabled),
  [role="button"]:active:not(:disabled),
  .clickable:active {
    transform: scale(var(--touch-feedback-scale));
    opacity: var(--touch-feedback-opacity);
    transition: transform 0.1s ease-out, opacity 0.1s ease-out;
  }
  
  /* 禁用悬停效果（触摸设备上不需要） */
  button:hover:not(:disabled),
  [role="button"]:hover:not(:disabled) {
    transform: none;
  }
  
  /* 保持按下效果 */
  button:active:not(:disabled),
  [role="button"]:active:not(:disabled) {
    transform: scale(var(--touch-feedback-scale));
  }
  
  /* 操作按钮特殊处理 */
  .operation-button:hover:not(.disabled) {
    transform: none;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
  }
  
  .operation-button:active:not(.disabled) {
    transform: scale(0.98);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.08);
  }
  
  /* 结束回合按钮 */
  .end-turn-button:hover:not(:disabled) {
    transform: none;
  }
  
  .end-turn-button:active:not(:disabled) {
    transform: scale(var(--touch-feedback-scale));
  }
  
  /* 保存/加载按钮触摸反馈 */
  .save-load-btn:active:not(:disabled) {
    transform: scale(var(--touch-feedback-scale));
  }
  
  /* 导航项触摸反馈 */
  .mobile-nav-item:active {
    transform: scale(var(--touch-feedback-scale));
  }
  
  /* 手风琴头部触摸反馈 */
  .accordion-header:active {
    transform: scale(0.98);
  }
  
  /* 弹窗按钮触摸反馈 */
  .modal-close-btn:active,
  .close-btn:active,
  .cancel-btn:active,
  .confirm-btn:active:not(:disabled) {
    transform: scale(var(--touch-feedback-scale));
  }
}

/* ============================================
   减少动画偏好支持
   ============================================ */

@media (pointer: coarse) and (prefers-reduced-motion: reduce) {
  button:active:not(:disabled),
  [role="button"]:active:not(:disabled),
  .clickable:active {
    transform: none;
  }
}
